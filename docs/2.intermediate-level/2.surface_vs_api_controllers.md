# üß© Surface vs API Controllers

> Learn the difference between **SurfaceControllers** and **API Controllers** in Umbraco v13 ‚Äî when to use each, how to build them, and how they integrate with views or frontend apps üéØüì°

---

## ‚öîÔ∏è Surface vs API Controller ‚Äì Quick Overview

| Controller Type      | Used For...                         | Returns         | Common Use                                  |
| -------------------- | ----------------------------------- | --------------- | ------------------------------------------- |
| üß± SurfaceController | Form submissions + server-side HTML | `IActionResult` | Contact forms, redirects, server-side logic |
| üì° API Controller    | Frontend APIs (JS/React/Vue)        | JSON            | Fetching data, headless API, integrations   |

---

## 1Ô∏è‚É£ üß± SurfaceController ‚Äì The Umbraco MVC Classic

### üí° Use it when

- You want to **submit a form**
- Redirect to another page
- Work in Razor pages (server-rendered)

---

### ‚úÖ Step-by-Step Example: Contact Form Submission

---

#### üß∞ Step 1: Create the Controller

üóÇ File: `Controllers/ContactSurfaceController.cs`

```csharp
using Microsoft.AspNetCore.Mvc;
using Umbraco.Cms.Web.Common.Controllers;

public class ContactSurfaceController : SurfaceController
{
    public ContactSurfaceController(
        IUmbracoContextAccessor umbracoContextAccessor,
        IUmbracoDatabaseFactory databaseFactory,
        ServiceContext services,
        Umbraco.Cms.Core.Web.IUmbracoContext umbracoContext,
        ITempDataDictionaryFactory tempDataFactory,
        IActionResultExecutor<ViewResult> viewResultExecutor)
        : base(umbracoContextAccessor, databaseFactory, services, umbracoContext, tempDataFactory, viewResultExecutor)
    {
    }

    [HttpPost]
    public IActionResult Submit(string name, string email, string message)
    {
        // Do something: save to DB, send email, etc.
        TempData["Success"] = "Thanks for contacting us!";
        return RedirectToCurrentUmbracoPage();
    }
}
```

---

#### üìÑ Step 2: Add the Razor Form

Inside a `.cshtml` view (like `Contact.cshtml`):

```cshtml
@using (Html.BeginUmbracoForm("Submit", "ContactSurface"))
{
    <input type="text" name="name" placeholder="Your name" />
    <input type="email" name="email" placeholder="Your email" />
    <textarea name="message" placeholder="Your message"></textarea>
    <button type="submit">Send</button>
}

@if (TempData["Success"] != null)
{
    <p>@TempData["Success"]</p>
}
```

---

### üß† Bonus: Use a ViewModel

```csharp
public class ContactFormModel
{
    public string Name { get; set; }
    public string Email { get; set; }
    public string Message { get; set; }
}
```

```csharp
[HttpPost]
public IActionResult Submit(ContactFormModel model)
```

---

## 2Ô∏è‚É£ üì° API Controller ‚Äì For JSON APIs / AJAX / JS

### üí° Use it when

- You‚Äôre building **headless APIs**
- Serving data to **React/Angular/Vue**
- Returning **JSON results**

---

### ‚úÖ Step-by-Step Example: Product API

---

#### üóÇ File: `Controllers/ProductApiController.cs`

```csharp
using Microsoft.AspNetCore.Mvc;
using Umbraco.Cms.Web.Common.Controllers;

[Route("api/[controller]")]
[ApiController]
public class ProductApiController : UmbracoApiController
{
    [HttpGet("{id}")]
    public IActionResult GetProduct(int id)
    {
        var product = new {
            Id = id,
            Name = "Banana T-Shirt",
            Price = 19.99
        };
        return Ok(product);
    }
}
```

---

#### üîó Call It From JavaScript

```javascript
fetch("/api/productapi/5")
  .then((res) => res.json())
  .then((data) => console.log(data));
```

---

### üì¶ Add Routing if Needed

If it doesn't work, update your `Program.cs`:

```csharp
app.UseEndpoints(endpoints =>
{
    endpoints.MapControllers(); // Needed for [ApiController]
    endpoints.MapUmbracoRoute(); // Required for SurfaceControllers
});
```

---

## üí¨ Comparison Table

| Feature               | SurfaceController               | API Controller              |
| --------------------- | ------------------------------- | --------------------------- |
| Inherits From         | `SurfaceController`             | `UmbracoApiController`      |
| Return Type           | `IActionResult` (HTML/Redirect) | `IActionResult` (JSON)      |
| Called From           | Razor Views (Forms)             | JS / AJAX / External Client |
| Use Case              | Forms, redirects                | APIs, integrations, JS apps |
| Routing               | Implicit (via Umbraco)          | Explicit `[Route(...)]`     |
| Requires AntiForgery? | ‚úÖ Yes (for forms)              | ‚ùå Not unless needed        |

---

## ‚úÖ Summary

| Task                      | Use This Controller |
| ------------------------- | ------------------- |
| Handle form submissions   | SurfaceController   |
| Return HTML views         | SurfaceController   |
| Return JSON               | API Controller      |
| Use in JavaScript fetch() | API Controller      |
| Use in Razor forms        | SurfaceController   |

---

## üî• Practice Challenge

- Build a `NewsletterSurfaceController` for newsletter sign-up
- Build an `ArticleApiController` that returns a list of blog posts in JSON
